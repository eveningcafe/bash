---

common:
  private:
    ip: "{{ vip.haproxy.ip }}"
    inf: "{{ keepalived.haproxy.iface }}"

ha_global:
  chroot: /var/lib/haproxy
  user: haproxy
  group: haproxy 
  maxconn: "{{ haproxy_env.MAXCONN }}" 
  stats_cnf:
    - opt: socket
      val: "/run/haproxy/admin.sock mode 660 level admin"
    - opt: timeout 
      val: 30s 

ha_defaults:
  mode: http
  options:
    - redispatch
    - httplog
    - forwardfor
  retries: 3
  timeout_cnf:
    - opt: http-request 
      val: 10s
    - opt: queue 
      val: 1m
    - opt: connect 
      val: 10s
    - opt: client 
      val: 1m
    - opt: server 
      val: 1m
    - opt: check 
      val: 10s

ha_frontend: 
  user: "{{ haproxy_env.USER }}" 
  pass: "{{ haproxy_env.PASS }}" 

ha_stats:
  ip: "{{ vip.haproxy.ip }}" 
  port: 1984
  mode: http
  stats_cnf: 
    - opt: enable
      val:
    - opt: uri
      val: "/"
    - opt: refresh
      val: 15s
    - opt: realm
      val: "Haproxy\\ Stats"
    - opt: auth
      val: "{{ ha_frontend.user }}:{{ ha_frontend.pass }}"

ha_bind_common_ips:
  - "{{ common.private.ip }}"
